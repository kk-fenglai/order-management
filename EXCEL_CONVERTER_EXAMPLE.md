# Excel转换功能使用示例

## 示例场景

假设客户在原始Excel文件中只填写了部分快递单号，系统会如何处理？

### 原始数据示例

| 姓名+拼音 | 国手机号 | 邮箱 | 货物1 | 货物2 | 货物3 | 货物4-10 |
|-----------|----------|------|-------|-------|-------|----------|
| 张三 | 13800138000 | zhang@test.com | 快递单号:快递单号:SF1234567890 | 快递单号:快递单号:SF1234567891 | | (空白) |
| 李四 | 13900139000 | li@test.com | 快递单号:快递单号:YT9876543210 | | | (空白) |
| 王五 | 13700137000 | wang@test.com | | 快递单号:快递单号:EMS1111111111 | | (空白) |

### 转换结果

系统会为每个有效的快递单号创建一行记录：

| 客户姓名 | 快递单号 | 中文品名 (必填) | 英文品名 (必填) | 备注 |
|----------|----------|-----------------|-----------------|------|
| 张三 | SF1234567890 | 待填写 | To be filled | 原始数据: 客户张三, 手机号13800138000, 邮箱zhang@test.com |
| 张三 | SF1234567891 | 待填写 | To be filled | 原始数据: 客户张三, 手机号13800138000, 邮箱zhang@test.com |
| 李四 | YT9876543210 | 待填写 | To be filled | 原始数据: 客户李四, 手机号13900139000, 邮箱li@test.com |
| 王五 | EMS1111111111 | 待填写 | To be filled | 原始数据: 客户王五, 手机号13700137000, 邮箱wang@test.com |

## 关键特性

### 1. 灵活填写支持
- ✅ 客户可以在货物1-10列中任意填写快递单号
- ✅ 不要求全部填写，空白列会被自动忽略
- ✅ 支持一个客户填写多个快递单号

### 2. 智能提取
- ✅ 自动识别"快递单号:快递单号:"前缀
- ✅ 提取真实的快递单号
- ✅ 过滤无效的空值
- ✅ 处理带后缀的格式（如",中文"）
- ✅ 跳过重复前缀的无效格式

### 3. 数据完整性
- ✅ 保留原始客户信息
- ✅ 在备注中记录原始数据
- ✅ 为每个快递单号创建独立记录

## 使用建议

1. **数据准备**: 确保Excel文件包含必要的列名
2. **格式检查**: 快递单号格式应为"快递单号:快递单号:实际单号"（支持带后缀如",中文"）
3. **转换后处理**: 手动完善必填字段（中文品名、英文品名等）
4. **数据验证**: 检查转换结果是否符合预期

## 常见情况

### 情况1: 客户只填写一个快递单号
- 输入: 只在货物1列填写快递单号
- 输出: 生成1条记录

### 情况2: 客户填写多个快递单号
- 输入: 在货物1、货物3、货物5列填写快递单号
- 输出: 生成3条记录

### 情况3: 客户没有填写任何快递单号
- 输入: 所有货物列都为空
- 输出: 该客户不会生成任何记录

### 情况4: 混合情况
- 输入: 部分客户填写多个快递单号，部分客户只填写一个
- 输出: 根据实际填写情况生成相应数量的记录

### 情况5: 数据格式问题
- 输入: 包含无效格式的数据（如重复前缀）
- 输出: 系统会自动跳过无效格式，只处理有效的快递单号

**有效格式示例**:
- `快递单号:快递单号:YT7559422946509,中文` ✅
- `快递单号:快递单号:SF1234567890,中文` ✅

**无效格式示例**:
- `快递单号:快递单号:快递单号:快递单号:快递单号:快递单号:快递单号:快递单号:快递单号:,中文品` ❌ 